---
package:
    name: glibc
    description: GNU Libc
    version: 2.17.0
    dependencies:
        - kernel-headers
        - tc-elf

sources:
    - file: glibc-2.17.tar.xz
      digest: sha1:e210daf1d5d6d6da7bf216fbaad4922bd642952b
      origins:
        - http://ftpmirror.gnu.org/glibc/glibc-2.17.tar.xz

build:
    - commands:
        - tar Jxf $_SRCDIR/glibc-2.17.tar.xz
        - mkdir -p glibc
    
    - workdir: glibc
      commands:
        - >
            CFLAGS="-O2 -U_FORTIFY_SOURCE -fno-stack-protector"
            PATH="$_RELBASE/$_DEP_TC_ELF/bin:$PATH"
            ../glibc-2.17/configure --prefix=/usr
            --build=x86_64-elf
            --host=x86_64-linux
            --with-headers=$_RELBASE/$_DEP_KERNEL_HEADERS/include
            --enable-add-ons
            --enable-kernel=2.6.34
            --disable-profile
        - make
        - make install install_root=$_RELDIR
        - cp -r $_RELBASE/$_DEP_KERNEL_HEADERS/include/* $_RELDIR/usr/include/