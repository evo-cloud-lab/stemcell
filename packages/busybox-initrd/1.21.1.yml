---
package:
    name: busybox-initrd
    description: Busybox for initrd
    version: 1.21.1
    dependencies:
        - tc-linux

sources:
    - file: busybox-1.21.1.tar.bz2
      digest: sha1:9244187d8d30447e165c694e89f4731c1705a53b
      origins:
        - http://busybox.net/downloads/busybox-1.21.1.tar.bz2

build:
    - commands:
        - tar jxf $_SRCDIR/busybox-1.21.1.tar.bz2
        - mkdir -p busybox
        - make -C busybox-1.21.1 defconfig O=$_BLDDIR/busybox
    
    - workdir: busybox
      commands:
        - cp -f $_PKGDIR/config-1.21.1 .config
        - sed -i -r "s|^(CONFIG_PREFIX=).*$|\\1\"$_RELDIR\"|" .config
        - sed -i -r "s|^(CONFIG_CROSS_COMPILER_PREFIX=).*$|\\1\"$_RELBASE/$_DEP_TC_LINUX/bin/x86_64-linux-\"|" .config        
        - make oldconfig
        - make V=1
        - make install
